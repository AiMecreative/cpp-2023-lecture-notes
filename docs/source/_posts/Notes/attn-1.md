---
title: Notes | 等号重载、模板
date: 2024-04-02 00:16:57
category: Notes
---

总结了一些关于提问较多的，关于运算符重载的问题

<!--more-->

# 等号重载问题

问题描述：按照语法规定，完成了等号重载，在逻辑上没有任何问题，但最后使用等号赋值时出现错误

常见错误：没有与“=”相匹配的操作数或运算符

```c++
// 实例代码
MyClass MyClass::operator=(MyClass& other) {
    // codes
}

// 实例使用

MyClass a();
// 调用等号重载
MyClass b = a;
```

可能原因：

1. 没有写拷贝构造（复制构造）函数：

```c++
// 复制构造函数
class MyClass {
  public:
    MyClass(const MyClass & other) {
        // codes
    }
};
```

**注意**：复制构造函数和带参构造不一样！！目前很多同学将其搞混

```c++
// 带参构造函数
class MyClass {
    int _p1;
    int _p2;
  public:
    MyClass(int p1, int p2) {
        // codes
    }
};
```

2. 将“临时对象”（右值）赋值给对象：

```c++
MyClass a(), b();
// 调用等号重载，报错
MyClass c = a + b;
```

这是因为`a+b`的值是右值，即一个“临时对象”，不能被写入，应该为`const`

```c++
MyClass MyClass::operator=(const MyClass& other) {
    // codes
}
```

3. 类外定义成员函数没有声明类空间，即缺少`MyClass::`：注意在类外定义成员函数时，除了构造函数和析构函数没有返回值以外，其它函数都有返回值，格式为：`<模板> 返回值 类名::成员函数(形参列表){函数实现}`

# 模板问题

> 在使用VS编写代码时，编辑器不会给出错误提示，这需要我们仔细写代码。
> - 关于为啥不会给错误提示：因为模板比较特殊，它们在使用时才会被 **编译** ，因此在写代码的时候你的IDE会忽略对它的检查

常见错误：编译器报错ERROR1001等在生成解决方案时出现的错误；链接错误，找不到模板定义等

解决方式：

1. 逐行检查语法错误：例如漏了分号，成员变量是否存在等低级语法错误
2. 将模板的声明和实现放在同一个文件（处理链接等问题）

# 其它调试技巧

1. 用好断点：发现大家在调试带有循环的语句时，单步调试进入循环后疯狂单步调试，以便快速结束该循环，但其实只要在循环语句的后面再打一个断点，点击继续，即可跳转到循环后：

```c++

--> 第一个断点 一些代码...
// 另一些代码
for (...) {
    for (...) {
        // 很多循环，但没有错误
        // 很多同学不会跳过，这时候只需要添加第二个断点即可
    }
}

--> 第二个断点 程序运行到第一个断点后，如果想直接运行完中间部分，直到第二个断点处，只需要在程序运行到第一个断点时按下“继续”即可一次性运行到下一个断点处
```

2. 在报错框中双击报错的那一行提示，可以跳转到报错位置
3. 观察地址：如果地址的样子特别规律，例如`0000000`, `FFFFFFF`, `dddddd`之类，要么是没有初始化，要么是new以后没有赋值；而如果地址是存在的，但仍然报错“访问冲突”之类的，大概率是访问越界（下标超出范围）


